<div class="card card-default vbox">
    <div class="card-header" style="display: flex;">
        <label style="flex: 1">Collaboration System</label>

        <button class="btn btn-light btn-xs" (click)="initIssueList()" [disabled]="!csWorking">
            <span class="fas fa-redo"></span>
        </button>
        <div class="dropdown ml-2" ngbDropdown>
            <button class="btn btn-xs btn-light dropdown-toggle" data-toggle="dropdown" ngbDropdownToggle>
                <span class="fas fa-cog"></span>
            </button>
            <div class="dropdown-menu float-right" ngbDropdownMenu>
                <a *ngIf="isCollProjManagementAuthorized()" class="dropdown-item" (click)="openProjectConfig()">Project configuration</a>
                <a class="dropdown-item" (click)="openUserConfig()">User configuration</a>
                <a *ngIf="isCollProjManagementAuthorized()" class="dropdown-item" [ngClass]="{ disabled : !csProjectLinked }" (click)="assignProject()">Assign CS project</a>
            </div>
        </div>

    </div>
    
    <div class="card-body vbox">

        <!-- Mandatory settings not configured (missing serverURL) -->
        <div *ngIf="!projSettingsConfigured; else elseBlock1" class="alert alert-warning" style="margin: 3px;">
            No Collaboration System has been configured. 
            <span *ngIf="isCollProjManagementAuthorized()">
                Please, <a style="cursor: pointer" (click)="openProjectConfig()">configure</a> a CS.
            </span>
        </div>
        <ng-template #elseBlock1>
            <!-- Mandatory settings configured, Mandatory preferences not configured (missing credentials) -->
            <div *ngIf="!userSettingsConfigured; else elseBlock2" class="alert alert-warning" style="margin: 3px;">
                You need to be logged to the CS in order to see the issues list. Please, 
                <a style="cursor: pointer" (click)="openUserConfig()">provide</a> your credentials.
            </div>
            <ng-template #elseBlock2>
                <!-- Mandatory settings and preferences configured, but no project is linked (optional settings) -->
                <div *ngIf="!csProjectLinked; else elseBlock3" class="alert alert-warning" style="margin: 3px;">
                    There is no CS project assigned to this Vocbench project.
                    <span *ngIf="isCollProjManagementAuthorized()">
                        <a style="cursor: pointer" (click)="assignProject()">Create or assign</a> a project.
                    </span>
                </div>
                <ng-template #elseBlock3>
                    <!-- All configured: mandatory settings and preferences, project linked -->
                    <div *ngIf="!csWorking" class="alert alert-warning" style="margin: 3px;">
                        Collaboration System seems to be configured but it is not working. 
                        Please, check that the configuration is valid, or be sure that the CS server is running.
                    </div>
                </ng-template>
            </ng-template>
        </ng-template>
        
        <issue-list *ngIf="csWorking"></issue-list>

    </div>

</div>
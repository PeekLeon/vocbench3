<div class="vbox">

    <!--Tabs navigation-->
    <ul class="nav nav-tabs" (click)="$event.preventDefault()">
        <li *ngFor="let t of tabs" [ngClass]="{active : t.active}">
            <a href (click)="selectTab(t)">
                Query
                <span *ngIf=(t.removable) class="glyphicon glyphicon-remove-circle"
                    (click)="closeTab(t)"
                    onmouseover="this.className='glyphicon glyphicon-remove-sign'; this.style.cursor='pointer'"
                    onmouseout="this.className='glyphicon glyphicon-remove-circle'; this.style.cursor='default'">
                </span>
            </a>
        </li>
        <li [ngClass]="{disabled : tabs.length==10}">
            <a href (click)="addTab()" style="font-weight: bold" 
                onmouseover="this.style.color='#555'" onmouseout="this.style.color='#337ab7'">
                +
            </a>
        </li>
    </ul>
    <!--Tabs content-->
    <div class="tab-content">
        <div *ngFor="let t of tabs" [ngClass]="{vbox : t.active}">
            <div *ngIf="t.active" class="vbox">
                
                <yasgui [query]="t.query" (querychange)="onQueryChange($event)"></yasgui>
                
                <!--Commands (submit, clear, inferred)-->
                <div style="margin: 5px 0;">
                    <button class="btn btn-xs btn-primary" type="button" (click)="doQuery(t)" [disabled]="t.queryInProgress || !t.queryValid">
                        Submit
                    </button>
                    <button class="btn btn-xs btn-info" type="button" (click)="clear(t)" [disabled]="!t.queryResult">Clear</button>
                    <div class="hbox" style="align-items: center; display: inline-flex;">
                        <label style="margin-right: 5px;">Include inferred statement:</label>
                        <input #inferredcb type="checkbox" (change)="t.inferred=inferredcb.checked">
                    </div>
                    <div *ngIf="t.queryResult" class="hbox pull-right" style="align-items: center">
                        <span style="display: inline; margin-left: 5px;">(Done in {{t.queryTime}})</span>
                        <div class="dropdown pull-right" style="margin-left: 5px;">
                            <button class="btn btn-default dropdown-toggle btn-xs" data-toggle="dropdown">
                                Save results as... <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a (click)="saveResultAsJSON(t)">Json</a></li>
                                <li><a (click)="saveResultAsText(t)">Plain text</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!--Query result-->
                <div *ngIf="t.queryResult" class="vbox">
                    <div class="scrollableContainer" style="border: 1px solid #ddd">
                        <table class="table table-striped table-condensed table-hoverable" style="flex: 1">
                            <thead>
                                <tr>
                                    <th *ngFor="let h of t.headers">{{h}}</th>
                                </tr>
                            </thead>
                            <tbody style="overflow: auto;">
                                <tr *ngFor="let bindings of t.queryResult">
                                    <template [ngIf]="t.resultType == 'graph'">
                                        <td *ngFor="let h of t.headers">{{bindings[h]}}</td>
                                    </template>
                                    <template [ngIf]="t.resultType == 'tuple'">
                                        <td *ngFor="let h of t.headers">{{bindings[h].value}}</td>
                                    </template>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
    

</div>